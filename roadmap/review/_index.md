---
title: Ревью
---

<style>
.article em { font-weight: 300; }
.paragraph strong:first-child .attr:first-child .delimiter { display: none; }
</style>

При  написании документов часто возникает необходимость в ревью -- возможности оставить комментарий к тексту, а также предложить какие-то правки текста документа. 

Ревью -- процесс недолгого жизненного цикла. Это как задача, которую необходимо либо выполнить, либо отменить. Если ревью затягивается -- оно теряет актуальность. 

Ревью может иметь несколько итераций. А также может быть многостадийным, когда в процессе задействованы разные роли -- это будет покрыто отдельным механизмом [Workflow](../workflow).

Ниже описан концепт, как этот механизм ревью мог бы работать.

### Как может инициироваться ревью

- **По запросу**. Явно, когда запрашивают ревью у какого-то конкретного человека или роли. Либо это ревью запрошено автоматически исходя из настроенного процесса Workflow.
- **Произвольно**. Любой читатель сам может инициировать ревью для каталога. В этом случае  Возможность ревью может быть ограничена правами.

### Участники ревью

В ревью участвуют две стороны. От каждой стороны может принимать участие несколько человек, но как правило это кто-то один.

- **Ревьювер** -- тот кто оставляет комментарии и предлагает изменение. 

  *Тот, кто хочет внести изменение, т.е. по смыслу значит сделать Merge Request*.
- **Ответственный** -- тот кто отвечает на комментарии и может принять изменение или не принять.
  
  *Тот, кто принимает Merge Request*.

## Примерный сценарий процесса ревью

### Начальное ревью 

**[who:Ревьювер]** читает документацию и у него возникает замечание к документу или видит фрагмент, который считает, что нужно исправить: 
- **Комментарий на абзац**. Когда наводится мышкой на абзац, сбоку от абзаца появляется блеклая иконка добавления комментария, нажимает ее.
- **Окно комментария**. Открывается окно добавления комментария такое же, как это реализовано сейчас. Т.к. это первый комментарий кнопка добавления комментария называется *Start review*. Нажимает ее.  Но мог бы явно нажать на кнопку *Suggest & Review* сверху в меню.
- **Подсветка изменения**. Абзац, к которому оставлен комментарий подсвечивается желтым фоном. Сбоку от абзаца, т.к. слева есть место, отображается текст введенного комментария. Если бы места не было, то отображалась бы просто подсвеченная иконка. 
- **Просмотр комментария**. При нажатии на комментарий -- он показывается в полном виде, появляются кнопки ответа. Внешний вид повторяет текущую реализацию.
- **Комментарий на фрагмент**. В тексте видит фразу, которая ему не нравится. Выделяет ее мышкой, появляется всплывающая иконка добавления комментария. Вводит комментарий.
- **Внесение предложений на изменение**. Т.к. находится в процессе ревью -- текст становится редактируемым. Вносит необходимое изменение.
- **Подсветка предложений**. Как и при обычном редактировании тут добавляется подсветка. Она может быть явнее и выделена другим стилем относительно обычного изменения при редактировании.
- **Посоветовать исправление**. В окне добавления комментария указывает, что в этом фрагменте текста не нравится, а также нажимает *Suggest* и во всплывающем окне вводит предлагаемую замену.
- **Ревью по множеству файлов**. Переключается в другую статью каталога и так же вносит комментарии в рамках той же сессии ревью.
- **Завершение ревью**. После внесения необходимых изменений нажимает кнопку *Submit*. В окне подтверждения смотрит все вносимые изменения и комментарии. 
  
  *При внесении изменений происходит коммит в отдельную ревью-ветку*.
- **Уведомление ответственному**. Ответственный за статью/раздел/каталог получает уведомление и переходит по ссылке на ревью.
- **Обновление ревью**. Замечает еще одну проблему, о которой хотели бы написать. Нажимает кнопку *Modify review*. Добавляет комментарий и редактирует. Приходит новое уведомление ответственному.

### Ответ на ревью

**[who:Ответственный]** получает уведомление и переходит по ссылке из него:
- **Роль Ответственный за каталог**. У каждого каталога может быть настроен ответственный (см. модуль Workflow).
- **Просмотр diff**. При переходе по ссылке из уведомления открывается режим просмотра изменений и комментариев. Новый текст подсвечен зеленым, удаленный или перемещенный текст зачеркнутым красным. Скрывает удаленный текст, чтобы не мешал.
- **Ответ на комментарии**. Видит комментарий, на который хочет ответить и вводит текст ответа.
- **Отмена изменений**. Нажимает на изменение, которое считает неверным и во всплывающем меню нажимает *Откатить*. Для тех изменений, с которыми согласен, не делает ничего.
- Обновляет ревью так же, как это делал ревьювер. 

### Вторая итерация ревью

**[who:Ревьювер]** продолжает ревью:
- **Уведомление ревьюверу**. Ревьювер получает уведомление и нажимает на ссылке.
- **Просмотр diff относительно своей версии**. При переходе видит diff относительно своей версии. А также может переключиться и посмотреть изменения относительно первоначального варианта.
- Просматривает изменения, вносит замечания, оставляет комментарии. После этого обновляет ревью. 

### Финализация ревью 

**[who:Ответственный]**. Получает уведомление и финализирует ревью:
- **Учет изменений**. Просматривает последние замечания. Понимает, что согласие достигнуто. Все комментарии становятся решенными и появляется кнопка *Merge review*, которая он нажимает. После этого в основную ветку вносятся все замечания, решенные комментарии удаляются и остаются только в истории.
