---
title: Комментарии
order: 7
---

Ревьюверы хотят оставлять комментарии к абзацам статей. А другие ревьюверы и авторы хотят просматривать комментарии, отвечать на них и обрабатывать.

### Какие задачи должны решаться

- Комментирование

   - Оставить комментарий к блоку статьи (абзацу, таблице, картинке)

   - Отредактировать комментарий

   - Ответить на существующий комментарий

   - Зарезолвить комментарий

- Просмотр

   - В левой навигации видеть что для статьи есть комментарии (можно так же как это реализовано сейчас).

   - Видеть что для абзаца текста есть комментарий и открыть просмотр цепочки комментариев.

   - Посмотреть какие есть комментарии для всех каталогов

### Общие соображения

- В обычных инструментах комментарии добавляются сразу же. У нас комментарии будут добавляться в рамках сессии редактирования каталога и считаться таким же редактированием как и остальная статья. И будут коммитится в репозиторий вместе с другими изменениями.

- По смыслу комментарии это TODO. Т.е. это задача, которую нужно выполнить. Т.е. она должна мозолить глаз пока не выполнена. А после выполнения -- исчезнуть.

Сейчас уже есть механизм комментариев, но он доступен не напрямую из статьи, а только из истории изменений, что очень неудобно для пользователя и не наглядно.

## Предложения

### UX

- Для абзацев с комментарием сбоку подсвечивается иконка с количеством комментариев там. Внешний вид иконки и кол-ва комментариев можно взять готовый.

- Важно, что для читателя должно быть заметно, что для абзаца есть комментарий. Возможно такому абзацу нужно добавить желтоватый бэкграунд (не уверен).

- При наведении на абзац, на который еще нет комментария сбоку показывать иконку. При нажатии на нее можно отобразить наше окно комментария.

- Было бы неплохо общий просмотр оставленных комментариев сделать по такому же принципу как inbox, незакоммиченные изменения. Т.е. при нажатии чтобы показывались все комментарии по каталогам.

- Важно посмотреть как комментарии сделаны в других известных инструментах. Например: Notion, Paper, Confluence, Google Docs.

### Техническая реализация

- Комментарии вставлять в специальных блоках либо в виде HTML-комментария, либо в кастомном блочном элементе. Например: `[comment:ruslan.adyukov:2022-01-01T01:03:02]`.

- Блоки комментариев вставлять сразу после блочных элементов, к которым они относятся.

- При резолве комментариев их блоке полностью удаляются из исходного кода и просмотреть зарезолвенные комментарии становится невозможно.

## Дальнейшие шаги

Если нужно сделать комментарий для конкретного текстового выделения, то можно сделать как в Notion -- там просто копируется текст, к которому был оставлен комментарий в сам комментарий. Если текст потом был изменен, то этот текст не меняется.